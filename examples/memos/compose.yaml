services:
  memos:
    image: neosmemo/memos:stable
    container_name: memos
    network_mode: bridge

    # Optional: Load custom configuration from .env file
    # Create .env to override any default values below
    env_file:
      - path: ./.env
        required: false     # Optional, won't fail if missing

    # Expose port (can be overridden with APP_PORT in .env)
    ports:
      - "${APP_PORT:-5230}:5230"

    # Persistent data volume
    volumes:
      - ${DATA_PATH:-./volumes/memos_data}:/var/opt/memos

    # WatchCow metadata labels
    # Default values are defined below with ${VAR:-default} syntax
    # To customize: create .env file with variables like APP_TITLE=My Custom Title
    labels:
      # Required: Basic app information
      watchcow.enable: "true"
      watchcow.appName: "${APP_NAME:-memos}"
      watchcow.appID: "${APP_ID:-1002}"
      watchcow.entryName: "${APP_ENTRY_NAME:-memos}"

      # Display information
      watchcow.title: "${APP_TITLE:-Memos}"
      watchcow.desc: "${APP_DESC:-轻量级笔记与知识管理工具}"
      watchcow.icon: "${APP_ICON:-https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/png/memos.png}"
      watchcow.category: "${APP_CATEGORY:-效率工具}"

      # Network configuration
      watchcow.protocol: "${APP_PROTOCOL:-http}"
      watchcow.port: "${APP_PORT:-5230}"
      watchcow.path: "${APP_PATH:-/}"
      watchcow.fnDomain: "${APP_FN_DOMAIN:-memos}"

      # App type flags
      watchcow.microApp: "${APP_MICRO_APP:-false}"
      watchcow.nativeApp: "${APP_NATIVE_APP:-false}"
      watchcow.isDisplay: "${APP_IS_DISPLAY:-true}"

    # Auto restart
    restart: unless-stopped
